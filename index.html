<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Impulse: AscensÃ£o Infinita ğŸš€</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body{margin:0;background:linear-gradient(135deg,#0f172a,#020617);color:#e2e8f0;font-family:Segoe UI;text-align:center}
h1{margin:10px 0;font-size:20px}
.stats{font-size:12px;margin:6px}
.section{margin:10px auto;width:92%;padding:12px;background:rgba(255,255,255,0.06);border-radius:12px}
button{margin:5px;padding:12px 16px;border:none;border-radius:10px;font-weight:bold;color:white;cursor:pointer}
.green{background:#22c55e}
.blue{background:#3b82f6}
.gold{background:#f59e0b}
.red{background:#ef4444}
.nav{position:fixed;bottom:0;width:100%;background:#0f172a;display:flex;justify-content:space-around;padding:8px 0}
.screen{display:none;padding-bottom:80px}
.screen.active{display:block}
.small{font-size:11px;color:#94a3b8}
</style>
</head>
<body>

<h1>Impulse: AscensÃ£o Infinita ğŸš€</h1>

<div class="stats">
ğŸª™ <span id="coins">0</span> |
â­ <span id="level">1</span> |
ğŸ”¥ <span id="xp">0</span> |
ğŸ’ <span id="prestige">0</span> |
ğŸ† <span id="league">Bronze</span>
</div>

<div id="home" class="screen active">
<div class="section">
<button class="green" onclick="clickGame()">TOCAR</button>
<button class="gold" onclick="openChest()">BAÃš</button>
</div>

<div class="section">
<button class="red" onclick="prestigeReset()">RENASCER</button>
<div class="small">Requer nÃ­vel 30 ou 5M moedas totais</div>
</div>
</div>

<div id="shop" class="screen">
<div class="section">
<h3>Upgrades</h3>
<div id="shopArea"></div>
</div>

<div class="section">
<h3>Artefatos (<span id="slotInfo"></span>)</h3>
<div id="artifactArea"></div>
</div>
</div>

<div class="nav">
<button onclick="show('home')">Home</button>
<button onclick="show('shop')">Loja</button>
</div>

<script>

const MAX_ARTIFACTS = 3;

const player={
coins:0,
level:1,
xp:0,
totalCoins:0,
prestige:0,
upgrades:{power:1},
artifacts:[],
lastLogin:Date.now()
};

function save(){
player.lastLogin=Date.now();
localStorage.setItem("impulse_final",JSON.stringify(player));
}

function load(){
const d=localStorage.getItem("impulse_final");
if(d)Object.assign(player,JSON.parse(d));
}

function league(){
if(player.prestige>=100)return "Diamante";
if(player.prestige>=50)return "Platina";
if(player.prestige>=20)return "Ouro";
if(player.prestige>=5)return "Prata";
return "Bronze";
}

function prestigeMultiplier(){
return 1 + player.prestige*0.05;
}

function artifactMultiplier(){
let m=1;
player.artifacts.forEach(a=>m+=a.value);
return m;
}

function totalMultiplier(){
return prestigeMultiplier()*artifactMultiplier();
}

function xpNeeded(){
return Math.floor(150*Math.pow(player.level,1.35));
}

function clickValue(){
return player.upgrades.power*totalMultiplier();
}

function clickGame(){
const gain=clickValue();
player.coins+=gain;
player.totalCoins+=gain;
player.xp+=10;
if(player.xp>=xpNeeded()){
player.xp=0;
player.level++;
}
save();updateUI();
}

function openChest(){
if(player.coins<1000)return alert("Precisa 1000 moedas.");
player.coins-=1000;

const roll=Math.random();

if(roll<0.6){
player.coins+=600;
alert("BaÃº comum +600 moedas");
}
else if(roll<0.9){
if(player.artifacts.length<MAX_ARTIFACTS){
player.artifacts.push({value:0.15});
alert("Artefato Raro +15%");
}else alert("Slots cheios.");
}
else{
if(player.artifacts.length<MAX_ARTIFACTS){
player.artifacts.push({value:0.30});
alert("ARTEFATO LENDÃRIO +30%");
}else alert("Slots cheios.");
}
save();updateUI();
}

function prestigeReset(){
if(player.level<30 && player.totalCoins<5000000){
return alert("Ainda nÃ£o pode renascer.");
}

const gained=Math.floor(Math.sqrt(player.totalCoins/500000));
if(gained<=0)return;

player.prestige+=gained;

player.coins=0;
player.level=1;
player.xp=0;
player.totalCoins=0;
player.upgrades={power:1};

alert("VocÃª ganhou "+gained+" Fragmentos CÃ³smicos!");

save();updateUI();
}

function offlineGain(){
const now=Date.now();
const diff=(now-player.lastLogin)/1000;
const gain=clickValue()*diff*0.6;

if(gain>0){
player.coins+=gain;
player.totalCoins+=gain;
alert("Offline: +"+Math.floor(gain)+" moedas");
}
}

function renderShop(){
const cost=Math.floor(200*Math.pow(1.20,player.upgrades.power));

shopArea.innerHTML=`
<p>Power: ${player.upgrades.power}</p>
<button onclick="buyPower(${cost})">+1 Power (${cost})</button>
`;

slotInfo.innerText=player.artifacts.length+"/"+MAX_ARTIFACTS;

artifactArea.innerHTML=player.artifacts.length===0
? "<p>Nenhum artefato.</p>"
: player.artifacts.map((a,i)=>`<p>#${i+1} +${Math.floor(a.value*100)}%</p>`).join("");
}

function buyPower(cost){
if(player.coins<cost)return;
player.coins-=cost;
player.upgrades.power++;
save();updateUI();
}

function show(id){
document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

function updateUI(){
coins.innerText=Math.floor(player.coins);
level.innerText=player.level;
xp.innerText=Math.floor(player.xp);
prestige.innerText=player.prestige;
leagueSpan=document.getElementById("league");
leagueSpan.innerText=league();
renderShop();
}

load();
offlineGain();
updateUI();
Telegram.WebApp.expand();

</script>
</body>
</html>
